
# Wazuh Stack 4.3.X

This environment will start a working deployment with:
  - wazuh manager
  - wazuh indexer
  - wazuh dashboard

Supported Wazuh versions:

	- 4.3.4
	- 4.3.3
	- 4.3.2
	- 4.3.1
	- 4.3.0

The images here used are generated by the CI/CD team and uploaded into the official Docker Hub organization.

### Image certificates

Certificates are created automatically by the docker-compose, but if it fails to create them with the apropriate permissions, we might need to adjust them.

This is related to the way the official Wazuh docker images are prepared.

### Registering agents using other docker images

To register an agent, we need to get the registering command from the UI and then execute:

For centos/8 images:

    $ docker run --rm --network wzd-pro-4.3.4 -d centos:8 bash -c '
    	sed -i -e "s|mirrorlist=|#mirrorlist=|g" /etc/yum.repos.d/CentOS-*
		sed -i -e "s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g" /etc/yum.repos.d/CentOS-*

		# Change this command by the one the UI suggest to use add it the -y and remove the sudo
		WAZUH_MANAGER='wazuh.manager' yum install -y https://packages.wazuh.com/4.x/yum5/x86_64/wazuh-agent-4.3.4-1.el5.x86_64.rpm

		/etc/init.d/wazuh-agent start
		tail -f /var/ossec/logs/ossec.log
	'

For ubuntu images 

    $ docker run --network wzd-pro-4.3.4 -d ubuntu:20.04 bash -c '
    	apt update -y
    	apt install -y curl lsb-release 
		# Change this command by the one the UI suggest to use add it tremove the sudo 
		curl -so wazuh-agent-4.3.4.deb https://packages.wazuh.com/4.x/apt/pool/main/w/wazuh-agent/wazuh-agent_4.3.4-1_amd64.deb && WAZUH_MANAGER='wazuh.manager' dpkg -i ./wazuh-agent-4.3.4.deb

		/etc/init.d/wazuh-agent start
		tail -f /var/ossec/logs/ossec.log
	'

For non linux agents:

We need to provision virtual machines.

